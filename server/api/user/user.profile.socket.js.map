{"version":3,"sources":["api/user/user.profile.socket.js"],"names":["getProfileLockManager","register","profileLockManagerSingleton","socket","profileLockManager","on","profileId","parseInt","join","broadcast","emit","id","sendLockList","lockName","acquireLock","releaseLock"],"mappings":"AAAA;;;;;QAMgBA,qB,GAAAA,qB;QAKAC,Q,GAAAA,Q;;AAThB;;;;;;AAEA,IAAIC,oCAAJ;;AAEO,SAASF,qBAAT,GAAiC;AACtCE,gCAA8BA,+BAA+B,2BAA7D;AACA,SAAOA,2BAAP;AACD;;AAEM,SAASD,QAAT,CAAkBE,MAAlB,EAA0B;AAC/B,MAAIC,qBAAqBJ,uBAAzB;;AAEAG,SAAOE,EAAP,CAAU,cAAV,EAA0B,UAASC,SAAT,EAAoB;AAC5CA,gBAAYC,SAASD,SAAT,CAAZ;AACAF,uBAAmBI,IAAnB,CAAwBL,MAAxB,EAAgCG,SAAhC;;AAEAH,WAAOM,SAAP,CAAiBC,IAAjB,CAAsB,oBAAtB,EAA4C,YAAYP,OAAOQ,EAAnB,GAAwB,sBAAxB,GAAiDL,SAA7F;AACD,GALD;;AAOAH,SAAOE,EAAP,CAAU,mBAAV,EAA+B,YAAW;AACxCD,uBAAmBQ,YAAnB,CAAgCT,MAAhC;AACD,GAFD;;AAIAA,SAAOE,EAAP,CAAU,sBAAV,EAAkC,UAASQ,QAAT,EAAmB;AACnDT,uBAAmBU,WAAnB,CAA+BX,MAA/B,EAAuCU,QAAvC;AACD,GAFD;;AAIAV,SAAOE,EAAP,CAAU,sBAAV,EAAkC,UAASQ,QAAT,EAAmB;AACnDT,uBAAmBW,WAAnB,CAA+BZ,MAA/B,EAAuCU,QAAvC;AACD,GAFD;AAGD","file":"api/user/user.profile.socket.js","sourcesContent":["'use strict';\n\nimport ProfileLockManager from './user.profile.lockmanager';\n\nlet profileLockManagerSingleton;\n\nexport function getProfileLockManager() {\n  profileLockManagerSingleton = profileLockManagerSingleton || new ProfileLockManager();\n  return profileLockManagerSingleton;\n}\n\nexport function register(socket) {\n  let profileLockManager = getProfileLockManager();\n\n  socket.on('profile:edit', function(profileId) {\n    profileId = parseInt(profileId);\n    profileLockManager.join(socket, profileId);\n\n    socket.broadcast.emit('profile:lock:debug', 'socket ' + socket.id + ' is editing profile ' + profileId);\n  });\n\n  socket.on('profile:lock:list', function() {\n    profileLockManager.sendLockList(socket);\n  });\n\n  socket.on('profile:lock:acquire', function(lockName) {\n    profileLockManager.acquireLock(socket, lockName);\n  });\n\n  socket.on('profile:lock:release', function(lockName) {\n    profileLockManager.releaseLock(socket, lockName);\n  });\n}"],"sourceRoot":"/source/"}